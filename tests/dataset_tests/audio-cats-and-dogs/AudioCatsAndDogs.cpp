#include <string>
#include "AudioCatsAndDogs.hpp"
#include "tools/Tools.hpp"
#include "AudioFile.h"

using namespace std;
using namespace snn;
using namespace internal;

AudioCatsAndDogs::AudioCatsAndDogs(std::string folderPath)
{
    this->loadData(folderPath);
}

void AudioCatsAndDogs::loadData(std::string folderPath)
{
    vector<string> fileNames[2]
    {
        {
            "cat_1.wav",
            "cat_10.wav",
            "cat_100.wav",
            "cat_101.wav",
            "cat_102.wav",
            "cat_103.wav",
            "cat_105.wav",
            "cat_106.wav",
            "cat_107.wav",
            "cat_108.wav",
            "cat_109.wav",
            "cat_11.wav",
            "cat_113.wav",
            "cat_114.wav",
            "cat_116.wav",
            "cat_117.wav",
            "cat_118.wav",
            "cat_119.wav",
            "cat_12.wav",
            "cat_120.wav",
            "cat_121.wav",
            "cat_122.wav",
            "cat_123.wav",
            "cat_124.wav",
            "cat_125.wav",
            "cat_127.wav",
            "cat_128.wav",
            "cat_13.wav",
            "cat_131.wav",
            "cat_132.wav",
            "cat_134.wav",
            "cat_136.wav",
            "cat_138.wav",
            "cat_139.wav",
            "cat_140.wav",
            "cat_141.wav",
            "cat_142.wav",
            "cat_146.wav",
            "cat_147.wav",
            "cat_149.wav",
            "cat_15.wav",
            "cat_150.wav",
            "cat_151.wav",
            "cat_153.wav",
            "cat_154.wav",
            "cat_155.wav",
            "cat_156.wav",
            "cat_157.wav",
            "cat_159.wav",
            "cat_16.wav",
            "cat_160.wav",
            "cat_161.wav",
            "cat_162.wav",
            "cat_163.wav",
            "cat_164.wav",
            "cat_165.wav",
            "cat_166.wav",
            "cat_167.wav",
            "cat_18.wav",
            "cat_19.wav",
            "cat_2.wav",
            "cat_21.wav",
            "cat_22.wav",
            "cat_23.wav",
            "cat_25.wav",
            "cat_26.wav",
            "cat_27.wav",
            "cat_30.wav",
            "cat_31.wav",
            "cat_32.wav",
            "cat_33.wav",
            "cat_34.wav",
            "cat_35.wav",
            "cat_37.wav",
            "cat_38.wav",
            "cat_39.wav",
            "cat_4.wav",
            "cat_40.wav",
            "cat_41.wav",
            "cat_43.wav",
            "cat_44.wav",
            "cat_45.wav",
            "cat_46.wav",
            "cat_47.wav",
            "cat_48.wav",
            "cat_49.wav",
            "cat_5.wav",
            "cat_50.wav",
            "cat_51.wav",
            "cat_52.wav",
            "cat_53.wav",
            "cat_54.wav",
            "cat_6.wav",
            "cat_60.wav",
            "cat_62.wav",
            "cat_63.wav",
            "cat_64.wav",
            "cat_65.wav",
            "cat_68.wav",
            "cat_69.wav",
            "cat_7.wav",
            "cat_70.wav",
            "cat_71.wav",
            "cat_72.wav",
            "cat_73.wav",
            "cat_74.wav",
            "cat_77.wav",
            "cat_78.wav",
            "cat_8.wav",
            "cat_80.wav",
            "cat_81.wav",
            "cat_83.wav",
            "cat_84.wav",
            "cat_87.wav",
            "cat_89.wav",
            "cat_9.wav",
            "cat_91.wav",
            "cat_92.wav",
            "cat_93.wav",
            "cat_94.wav",
            "cat_95.wav",
            "cat_96.wav",
            "cat_97.wav",
            "cat_98.wav",
            "cat_99.wav",
            "dog_barking_0.wav",
            "dog_barking_1.wav",
            "dog_barking_10.wav",
            "dog_barking_100.wav",
            "dog_barking_101.wav",
            "dog_barking_102.wav",
            "dog_barking_103.wav",
            "dog_barking_104.wav",
            "dog_barking_105.wav",
            "dog_barking_106.wav",
            "dog_barking_107.wav",
            "dog_barking_108.wav",
            "dog_barking_109.wav",
            "dog_barking_11.wav",
            "dog_barking_110.wav",
            "dog_barking_111.wav",
            "dog_barking_13.wav",
            "dog_barking_14.wav",
            "dog_barking_16.wav",
            "dog_barking_17.wav",
            "dog_barking_18.wav",
            "dog_barking_2.wav ",
            "dog_barking_20.wav",
            "dog_barking_21.wav",
            "dog_barking_22.wav",
            "dog_barking_23.wav",
            "dog_barking_25.wav",
            "dog_barking_26.wav",
            "dog_barking_27.wav",
            "dog_barking_28.wav",
            "dog_barking_29.wav",
            "dog_barking_30.wav",
            "dog_barking_31.wav",
            "dog_barking_32.wav",
            "dog_barking_33.wav",
            "dog_barking_35.wav",
            "dog_barking_36.wav",
            "dog_barking_37.wav",
            "dog_barking_38.wav",
            "dog_barking_39.wav",
            "dog_barking_4.wav ",
            "dog_barking_40.wav",
            "dog_barking_41.wav",
            "dog_barking_42.wav",
            "dog_barking_47.wav",
            "dog_barking_5.wav",
            "dog_barking_50.wav",
            "dog_barking_51.wav",
            "dog_barking_52.wav",
            "dog_barking_53.wav",
            "dog_barking_55.wav",
            "dog_barking_56.wav",
            "dog_barking_57.wav",
            "dog_barking_58.wav",
            "dog_barking_6.wav",
            "dog_barking_60.wav",
            "dog_barking_61.wav",
            "dog_barking_63.wav",
            "dog_barking_65.wav",
            "dog_barking_67.wav",
            "dog_barking_68.wav",
            "dog_barking_69.wav",
            "dog_barking_70.wav",
            "dog_barking_71.wav",
            "dog_barking_72.wav",
            "dog_barking_74.wav",
            "dog_barking_75.wav",
            "dog_barking_76.wav",
            "dog_barking_77.wav",
            "dog_barking_79.wav",
            "dog_barking_80.wav",
            "dog_barking_81.wav",
            "dog_barking_83.wav",
            "dog_barking_84.wav",
            "dog_barking_85.wav",
            "dog_barking_86.wav",
            "dog_barking_87.wav",
            "dog_barking_88.wav",
            "dog_barking_92.wav",
            "dog_barking_93.wav",
            "dog_barking_94.wav",
            "dog_barking_95.wav",
            "dog_barking_96.wav",
            "dog_barking_97.wav",
            "dog_barking_98.wav",
        },
        {
            "cat_110.wav",
            "cat_112.wav",
            "cat_115.wav",
            "cat_126.wav",
            "cat_129.wav",
            "cat_130.wav",
            "cat_133.wav",
            "cat_135.wav",
            "cat_137.wav",
            "cat_14.wav",
            "cat_143.wav",
            "cat_144.wav",
            "cat_148.wav",
            "cat_152.wav",
            "cat_158.wav",
            "cat_17.wav",
            "cat_20.wav",
            "cat_24.wav",
            "cat_28.wav",
            "cat_29.wav",
            "cat_3.wav ",
            "cat_36.wav",
            "cat_42.wav",
            "cat_55.wav",
            "cat_56.wav",
            "cat_57.wav",
            "cat_58.wav",
            "cat_59.wav",
            "cat_61.wav",
            "cat_66.wav",
            "cat_67.wav",
            "cat_75.wav",
            "cat_76.wav",
            "cat_79.wav",
            "cat_82.wav",
            "cat_85.wav",
            "cat_86.wav",
            "cat_88.wav",
            "cat_90.wav",
            "dog_barking_112.wav",
            "dog_barking_12.wav",
            "dog_barking_15.wav",
            "dog_barking_19.wav",
            "dog_barking_24.wav",
            "dog_barking_3.wav ",
            "dog_barking_34.wav",
            "dog_barking_43.wav",
            "dog_barking_44.wav",
            "dog_barking_45.wav",
            "dog_barking_46.wav",
            "dog_barking_48.wav",
            "dog_barking_49.wav",
            "dog_barking_54.wav",
            "dog_barking_59.wav",
            "dog_barking_62.wav",
            "dog_barking_64.wav",
            "dog_barking_66.wav",
            "dog_barking_7.wav ",
            "dog_barking_73.wav",
            "dog_barking_78.wav",
            "dog_barking_8.wav ",
            "dog_barking_82.wav",
            "dog_barking_89.wav",
            "dog_barking_9.wav ",
            "dog_barking_90.wav",
            "dog_barking_91.wav",
            "dog_barking_99.wav",
        }
    };

    vector2D<float> labels[2];
    vector3D<float> inputs[2];

    for (int i = 0; i < 2; ++i)
    {
        for (auto fileName : fileNames[i])
        {
            AudioFile<float> audioFile;
            audioFile.load(folderPath + fileName); ////////

            const int channel = 0; // only one
            const int numberOfSamples = audioFile.getNumSamplesPerChannel();

            vector2D<float> dataSound;
            dataSound.reserve(numberOfSamples / 16);

            for (int i = 0; i < numberOfSamples; i++) // Sample Rate 16000
            {
                if (i % 16 == 0)
                {
                    dataSound.push_back({});
                    dataSound.back().reserve(16);
                }
                const float sample = audioFile.samples[channel][i];
                dataSound.back().push_back(sample);
            }
            inputs[i].push_back(dataSound);

            if (fileName.find("cat") != std::string::npos)
            {
                labels[i].push_back({1, 0});
            }
            if (fileName.find("dog") != std::string::npos)
            {
                labels[i].push_back({0, 1});
            }
            else
            {
                throw runtime_error("Wrong file name: " + fileName);
            }
        }
    }
    this->data = make_unique<Data>(classification,
                                   inputs[0],
                                   labels[0],
                                   inputs[1],
                                   labels[1],
                                   temporal);
}
